# Custom Filename Feature

## Overview

The custom filename feature allows users to specify a custom base name for all output files generated by the Dictation Builder. This makes it easier to organize and identify different dictation projects.

## Feature Details

### Location
**Tab 3: Build & Download** section of the Streamlit UI

### Components

1. **Filename Input Field**
   - Text input for custom base filename
   - Default value: "dictation_final"
   - Placeholder text guides user
   - Automatically sanitizes invalid characters

2. **Reset Button**
   - Quickly restore default filename
   - Convenient for standard workflows

3. **Preview Caption**
   - Shows exactly what the output files will be named
   - Updates in real-time as user types

### File Naming Convention

The custom base filename is used to generate three output files:

| File Type | Naming Pattern | Example |
|-----------|----------------|---------|
| Audio (MP3) | `{base_name}.mp3` | `Unit_4A.mp3` |
| Audio (WAV) | `{base_name}.wav` | `Unit_4A.wav` |
| Manifest | `{base_name}_manifest.json` | `Unit_4A_manifest.json` |
| Report | `{base_name}_report.json` | `Unit_4A_report.json` |

### Filename Sanitization

The feature automatically sanitizes filenames by:
- Removing invalid characters: `< > : " / \ | ? *`
- Replacing them with underscores `_`
- Ensuring the filename is not empty (falls back to "dictation_final")

**Examples:**
- Input: `Unit 4A: Titanic` → Output: `Unit_4A__Titanic`
- Input: `Lesson/2/Part1` → Output: `Lesson_2_Part1`
- Input: ` ` (empty) → Output: `dictation_final`

## Usage Example

### Scenario 1: Standard Unit Naming
```
Input filename: Unit_4A
Generated files:
  - Unit_4A.mp3
  - Unit_4A_manifest.json
  - Unit_4A_report.json
```

### Scenario 2: Descriptive Naming
```
Input filename: TitanicStory_Slow_3x5rep
Generated files:
  - TitanicStory_Slow_3x5rep.mp3
  - TitanicStory_Slow_3x5rep_manifest.json
  - TitanicStory_Slow_3x5rep_report.json
```

### Scenario 3: Date-based Naming
```
Input filename: 2024-10-23_Session1
Generated files:
  - 2024-10-23_Session1.mp3
  - 2024-10-23_Session1_manifest.json
  - 2024-10-23_Session1_report.json
```

## User Interface

### Layout

```
┌─────────────────────────────────────────────────────────┐
│ 📝 Output Files                                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ Base filename (without extension)    [🔄 Reset]        │
│ ┌──────────────────────────────┐                       │
│ │ Unit_4A                       │                       │
│ └──────────────────────────────┘                       │
│                                                         │
│ 📁 Files will be named: Unit_4A.mp3,                   │
│    Unit_4A_manifest.json, Unit_4A_report.json          │
└─────────────────────────────────────────────────────────┘
```

## Benefits

1. **Organization**
   - Easy to identify output files by content
   - Better file management for multiple projects

2. **Clarity**
   - Descriptive names help track different versions
   - Include settings in filename (e.g., `_3x5rep` for repetition counts)

3. **Workflow Integration**
   - Custom names match internal project naming conventions
   - Easier to find specific audio files later

4. **Flexibility**
   - Any valid filename characters supported
   - Auto-sanitization prevents errors

## Implementation Details

### Code Location
**File:** `app.py`  
**Section:** Tab 3 - Build & Download (lines ~893-916)

### Key Features
- Real-time filename preview
- Automatic sanitization using regex
- Reset functionality for convenience
- Integrated with download buttons

### Download Buttons
All three download buttons now use the custom filename:

```python
# MP3 Audio
file_name=f"{custom_filename}.mp3"

# WAV Audio (fallback)
file_name=f"{custom_filename}.wav"

# Manifest
file_name=f"{custom_filename}_manifest.json"

# Report
file_name=f"{custom_filename}_report.json"
```

## Best Practices

### Recommended Naming Conventions

1. **Unit-based:**
   - `Unit_1A`, `Unit_1B`, `Unit_2A`, etc.

2. **Topic-based:**
   - `Titanic_Story`, `Weather_Lesson`, `Food_Vocab`, etc.

3. **Date-based:**
   - `2024-10-23_Lesson1`, `2024-10-23_Lesson2`, etc.

4. **Settings-based:**
   - `Unit4A_92tempo_3x5rep` (includes tempo and repetition settings)

5. **Version-based:**
   - `Titanic_v1`, `Titanic_v2_revised`, etc.

### Characters to Avoid
While the system sanitizes automatically, try to avoid these for clarity:
- Special characters: `< > : " / \ | ? *`
- Use underscores `_` or hyphens `-` instead of spaces

## Future Enhancements

Potential future improvements:
- Template-based naming (e.g., `{date}_{unit}_{version}`)
- Automatic naming suggestions based on content
- History of recently used filenames
- Filename validation with preview of sanitized version
- Option to include settings automatically (tempo, repetitions, etc.)

---

**Date Implemented:** October 23, 2024  
**Version:** 1.2.0  
**Feature Request:** User-specified output filename customization

